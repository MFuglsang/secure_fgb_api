{"version":3,"sources":["../../../../src/ts/ol.spec.ts"],"sourcesContent":["import { readFileSync } from 'node:fs';\nimport Feature, { type FeatureLike } from 'ol/Feature.js';\nimport GeoJSON from 'ol/format/GeoJSON.js';\nimport WKT from 'ol/format/WKT.js';\nimport type Geometry from 'ol/geom/Geometry.js';\nimport type Point from 'ol/geom/Point.js';\nimport type SimpleGeometry from 'ol/geom/SimpleGeometry.js';\nimport { transform } from 'ol/proj';\nimport RenderFeature from 'ol/render/Feature.js';\nimport { describe, expect, it } from 'vitest';\nimport { deserialize, FeatureCollection, serialize } from './ol.js';\nimport { arrayToStream, takeAsync } from './streams/utils.js';\n\nconst format = new WKT();\nconst geojson = new GeoJSON();\n\nconst g = (features: Array<Feature<Geometry>>) => geojson.writeFeatures(features);\n\nfunction makeFeatureCollection(wkt: string /*, properties?: any*/) {\n    return makeFeatureCollectionFromArray([wkt] /*, properties*/);\n}\n\nfunction makeFeatureCollectionFromArray(wkts: string[] /*, properties?: any*/): Feature[] {\n    const geometries = wkts.map((wkt) => format.readGeometry(wkt));\n    const features = geometries.map((geometry, index) => {\n        const f = new Feature({ geometry });\n        f.setId(index);\n        return f;\n    });\n    return features;\n}\n\ndescribe('ol module', () => {\n    describe('Geometry roundtrips', () => {\n        const fc = new FeatureCollection();\n\n        it('Point', async () => {\n            const expected = makeFeatureCollection('POINT(1.2 -2.1)');\n            const s = serialize(fc, expected);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, s))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('Point via stream', async () => {\n            const expected = makeFeatureCollection('POINT(1.2 -2.1)');\n            const s = serialize(fc, expected);\n            const stream = arrayToStream(s);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, stream))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('Point Z', async () => {\n            const expected = makeFeatureCollection('POINT Z(1.2 -2.1 5)');\n            const s = serialize(fc, expected);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, s))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('Point M', async () => {\n            const expected = makeFeatureCollection('POINT M(1.2 -2.1 5)');\n            const s = serialize(fc, expected);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, s))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('Point ZM', async () => {\n            const expected = makeFeatureCollection('POINT ZM(1.2 -2.1 5 12.8)');\n            const s = serialize(fc, expected);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, s))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('Points', async () => {\n            const expected = makeFeatureCollectionFromArray(['POINT(1.2 -2.1)', 'POINT(2.4 -4.8)']);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('Points Z', async () => {\n            const expected = makeFeatureCollectionFromArray(['POINT Z(1.2 -2.1 5)', 'POINT Z(2.4 -4.8 5.6)']);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPoint', async () => {\n            const expected = makeFeatureCollection('MULTIPOINT(10 40, 40 30, 20 20, 30 10)');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPoint Z', async () => {\n            const expected = makeFeatureCollection('MULTIPOINT Z(10 40 0.5, 40 30 0.5, 20 20 0.5, 30 10 0.5)');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPoint ZM', async () => {\n            const expected = makeFeatureCollection('MULTIPOINT ZM(10 40 0.5 1, 40 30 0.5 1, 20 20 0.5 1, 30 10 0.5 1)');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('LineString', async () => {\n            const expected = makeFeatureCollection('LINESTRING(1.2 -2.1, 2.4 -4.8)');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('LineString Z', async () => {\n            const expected = makeFeatureCollection('LINESTRING Z(1.2 -2.1 5, 2.4 -4.8 0.5)');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('LineString ZM', async () => {\n            const expected = makeFeatureCollection('LINESTRING ZM(1.2 -2.1 5 1, 2.4 -4.8 0.5 1)');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiLineString', async () => {\n            const expected = makeFeatureCollection(`MULTILINESTRING((10 10, 20 20, 10 40),\n (40 40, 30 30, 40 20, 30 10), (50 50, 60 60, 50 90))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiLineString Z', async () => {\n            const expected = makeFeatureCollection(`MULTILINESTRING Z((10 10 5, 20 20 0.5, 10 40 12.1),\n (40 40 4, 30 30 3, 40 20 2, 30 10 1), (50 50 5, 60 60 6, 50 90 9))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiLineString ZM', async () => {\n            const expected = makeFeatureCollection(`MULTILINESTRING ZM((10 10 5 1, 20 20 0.5 1, 10 40 12.1 1),\n (40 40 4 1, 30 30 3 1, 40 20 2 1, 30 10 1 2), (50 50 5 1, 60 60 6 1, 50 90 9 1))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiLineStringSinglePart', async () => {\n            const expected = makeFeatureCollection('MULTILINESTRING((1.2 -2.1, 2.4 -4.8))');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('Polygon', async () => {\n            const expected = makeFeatureCollection('POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('Polygon Z', async () => {\n            const expected = makeFeatureCollection('POLYGON Z((30 10 12.1, 40 40 4, 20 40 4, 10 20 0.5, 30 10 12))');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('Polygon ZM', async () => {\n            const expected = makeFeatureCollection(\n                'POLYGON ZM((30 10 12.1 1, 40 40 4 1, 20 40 4 1, 10 20 0.5 1, 30 10 12 1))',\n            );\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('PolygonWithHole', async () => {\n            const expected = makeFeatureCollection(`POLYGON ((35 10, 45 45, 15 40, 10 20, 35 10),\n (20 30, 35 35, 30 20, 20 30))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('PolygonWithHole Z', async () => {\n            const expected = makeFeatureCollection(`POLYGON Z ((35 10 4, 45 45 4, 15 40 4, 10 20 4, 35 10 4),\n (20 30 4, 35 35 4, 30 20 4, 20 30 4))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('PolygonWithHole ZM', async () => {\n            const expected = makeFeatureCollection(`POLYGON ZM ((35 10 4 1, 45 45 4 1, 15 40 4 1, 10 20 4 1, 35 10 4 1),\n (20 30 4 1, 35 35 4 1, 30 20 4 1, 20 30 4 1))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('PolygonWithTwoHoles', async () => {\n            const expected = makeFeatureCollection(`POLYGON ((35 10, 45 45, 15 40, 10 20, 35 10),\n (20 30, 35 35, 30 20, 20 30), (20 30, 35 35, 30 20, 20 30))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPolygon', async () => {\n            const expected = makeFeatureCollection(`MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)),\n ((15 5, 40 10, 10 20, 5 10, 15 5)))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            // should encode into 18 flat coords, ends [8, 16] endss [1, 1]\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPolygon Z', async () => {\n            const expected = makeFeatureCollection(`MULTIPOLYGON Z (((30 20 1, 45 40 3, 10 40 4, 30 20 6)),\n ((15 5 1, 40 10 1, 10 20 1, 5 10 1, 15 5 1)))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            // should encode into 18 flat coords, ends [8, 16] endss [1, 1]\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPolygon ZM', async () => {\n            const expected = makeFeatureCollection(`MULTIPOLYGON ZM (((30 20 1 2, 45 40 3 2, 10 40 4 2, 30 20 6 2)),\n ((15 5 1 2, 40 10 1 2, 10 20 1 2, 5 10 1 2, 15 5 1 2)))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            // should encode into 18 flat coords, ends [8, 16] endss [1, 1]\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPolygonWithHole', async () => {\n            const expected = makeFeatureCollection(`MULTIPOLYGON (((40 40, 20 45, 45 30, 40 40)),\n ((20 35, 10 30, 10 10, 30 5, 45 20, 20 35), (30 20, 20 15, 20 25, 30 20)))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            // NOTE: 28 flat coords, ends = [4, 10, 14], endss = [1, 2]\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPolygonWithHole Z', async () => {\n            const expected = makeFeatureCollection(`MULTIPOLYGON Z(((40 40 1, 20 45 1, 45 30 1, 40 40 1)),\n ((20 35 1, 10 30 1, 10 10 1, 30 5 1, 45 20 1, 20 35 1), (30 20 1, 20 15 1, 20 25 1, 30 20 1)))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            // NOTE: 28 flat coords, ends = [4, 10, 14], endss = [1, 2]\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPolygonWithHole ZM', async () => {\n            const expected = makeFeatureCollection(`MULTIPOLYGON ZM (((40 40 1 2, 20 45 1 2, 45 30 1 2, 40 40 1 2)),\n ((20 35 1 2, 10 30 1 2, 10 10 1 2, 30 5 1 2, 45 20 1 2, 20 35 1 2), (30 20 1 2, 20 15 1 2, 20 25 1 2, 30 20 1 2)))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            // NOTE: 28 flat coords, ends = [4, 10, 14], endss = [1, 2]\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPolygonSinglePart', async () => {\n            const expected = makeFeatureCollection('MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)))');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPolygonSinglePartWithHole', async () => {\n            const expected = makeFeatureCollection(`MULTIPOLYGON (((35 10, 45 45, 15 40, 10 20, 35 10),\n (20 30, 35 35, 30 20, 20 30))))`);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as Feature[];\n            expect(g(actual)).to.equal(g(expected));\n        });\n\n        it('MultiPolygon with two holes', async () => {\n            const expected = {\n                type: 'FeatureCollection',\n                features: [\n                    {\n                        type: 'Feature',\n                        id: 0,\n                        properties: { test: 1 },\n                        geometry: {\n                            type: 'MultiPolygon',\n                            coordinates: [\n                                [\n                                    [\n                                        [102.0, 2.0],\n                                        [103.0, 2.0],\n                                        [103.0, 3.0],\n                                        [102.0, 3.0],\n                                        [102.0, 2.0],\n                                    ],\n                                ],\n                                [\n                                    [\n                                        [100.0, 0.0],\n                                        [101.0, 0.0],\n                                        [101.0, 1.0],\n                                        [100.0, 1.0],\n                                        [100.0, 0.0],\n                                    ],\n                                    [\n                                        [100.2, 0.2],\n                                        [100.8, 0.2],\n                                        [100.8, 0.8],\n                                        [100.2, 0.8],\n                                        [100.2, 0.2],\n                                    ],\n                                ],\n                            ],\n                        },\n                    },\n                ],\n            };\n            const actual = (await takeAsync<FeatureLike>(\n                deserialize(fc, serialize(fc, geojson.readFeatures(expected))),\n            )) as Feature[];\n            expect(JSON.parse(g(actual))).to.deep.equal(expected);\n        });\n\n        it('Should parse UScounties fgb produced from GDAL array buffer', async () => {\n            const buffer = readFileSync('./test/data/UScounties.fgb');\n            const bytes = new Uint8Array(buffer);\n            const features = (await takeAsync<FeatureLike>(deserialize(fc, bytes))) as Feature[];\n            expect(features.length).to.eq(3221);\n            for (const f of features)\n                expect((f.getGeometry() as SimpleGeometry).getCoordinates()?.length).to.be.greaterThan(0);\n        });\n\n        it('Should parse countries fgb produced from GDAL array buffer', async () => {\n            const buffer = readFileSync('./test/data/countries.fgb');\n            const bytes = new Uint8Array(buffer);\n            const features = (await takeAsync<FeatureLike>(deserialize(fc, bytes))) as Feature[];\n            expect(features.length).to.eq(179);\n            for (const f of features)\n                expect((f.getGeometry() as SimpleGeometry).getCoordinates()?.length).to.be.greaterThan(0);\n        });\n\n        it('Should parse countries fgb produced from GDAL stream', async () => {\n            const buffer = readFileSync('./test/data/countries.fgb');\n            const bytes = new Uint8Array(buffer);\n            const stream = arrayToStream(bytes.buffer);\n            const features = (await takeAsync<FeatureLike>(deserialize(fc, stream))) as Feature[];\n            expect(features.length).to.eq(179);\n            for (const f of features)\n                expect((f.getGeometry() as SimpleGeometry).getCoordinates()?.length).to.be.greaterThan(0);\n        });\n\n        it('Bahamas', async () => {\n            const expected = {\n                type: 'FeatureCollection',\n                features: [\n                    {\n                        type: 'Feature',\n                        id: 0,\n                        properties: { name: 'The Bahamas' },\n                        geometry: {\n                            type: 'MultiPolygon',\n                            coordinates: [\n                                [\n                                    [\n                                        [-77.53466, 23.75975],\n                                        [-77.78, 23.71],\n                                        [-78.03405, 24.28615],\n                                        [-78.40848, 24.57564],\n                                        [-78.19087, 25.2103],\n                                        [-77.89, 25.17],\n                                        [-77.54, 24.34],\n                                        [-77.53466, 23.75975],\n                                    ],\n                                ],\n                                [\n                                    [\n                                        [-77.82, 26.58],\n                                        [-78.91, 26.42],\n                                        [-78.98, 26.79],\n                                        [-78.51, 26.87],\n                                        [-77.85, 26.84],\n                                        [-77.82, 26.58],\n                                    ],\n                                ],\n                                [\n                                    [\n                                        [-77, 26.59],\n                                        [-77.17255, 25.87918],\n                                        [-77.35641, 26.00735],\n                                        [-77.34, 26.53],\n                                        [-77.78802, 26.92516],\n                                        [-77.79, 27.04],\n                                        [-77, 26.59],\n                                    ],\n                                ],\n                            ],\n                        },\n                    },\n                ],\n            };\n            const actual = (await takeAsync<FeatureLike>(\n                deserialize(fc, serialize(fc, geojson.readFeatures(expected))),\n            )) as Feature[];\n            expect(JSON.parse(g(actual))).to.deep.equal(expected);\n        });\n\n        it('Heterogeneous geometry types', async () => {\n            const expected = {\n                type: 'FeatureCollection',\n                features: [\n                    {\n                        type: 'Feature',\n                        id: 0,\n                        properties: { name: 'A' },\n                        geometry: {\n                            type: 'Point',\n                            coordinates: [-77.53466, 23.75975],\n                        },\n                    },\n                    {\n                        type: 'Feature',\n                        id: 1,\n                        properties: { name: 'B' },\n                        geometry: {\n                            type: 'LineString',\n                            coordinates: [\n                                [-77.53466, 23.75975],\n                                [-77, 26.59],\n                            ],\n                        },\n                    },\n                ],\n            };\n            const actual = (await takeAsync<FeatureLike>(\n                deserialize(fc, serialize(fc, geojson.readFeatures(expected))),\n            )) as Feature[];\n            expect(JSON.parse(g(actual))).to.deep.equal(expected);\n        });\n\n        it('Heterogeneous geometry types Z', async () => {\n            const expected = {\n                type: 'FeatureCollection',\n                features: [\n                    {\n                        type: 'Feature',\n                        id: 0,\n                        properties: { name: 'A' },\n                        geometry: {\n                            type: 'Point',\n                            coordinates: [-77.53466, 23.75975, 12],\n                        },\n                    },\n                    {\n                        type: 'Feature',\n                        id: 1,\n                        properties: { name: 'B' },\n                        geometry: {\n                            type: 'LineString',\n                            coordinates: [\n                                [-77.53466, 23.75975, 12],\n                                [-77, 26.59, 12],\n                            ],\n                        },\n                    },\n                ],\n            };\n            const actual = (await takeAsync<FeatureLike>(\n                deserialize(fc, serialize(fc, geojson.readFeatures(expected))),\n            )) as Feature[];\n            expect(JSON.parse(g(actual))).to.deep.equal(expected);\n        });\n    });\n\n    describe('Geometry roundtrips with RenderFeatures', () => {\n        const fc = new FeatureCollection({\n            featureClass: RenderFeature,\n        });\n\n        it('Point', async () => {\n            const expected = makeFeatureCollection('POINT(1.2 -2.1)');\n            const s = serialize(fc, expected);\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, s))) as RenderFeature[];\n            expect(actual[0].getType()).toEqual('Point');\n            expect(actual[0].getFlatCoordinates()).toEqual([1.2, -2.1]);\n        });\n\n        it('MultiPoint', async () => {\n            const expected = makeFeatureCollection('MULTIPOINT(10 40, 40 30, 20 20, 30 10)');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as RenderFeature[];\n            expect(actual[0].getType()).toEqual('MultiPoint');\n            expect(actual[0].getFlatCoordinates()).toEqual([10, 40, 40, 30, 20, 20, 30, 10]);\n        });\n\n        it('LineString', async () => {\n            const expected = makeFeatureCollection('LINESTRING(1.2 -2.1, 2.4 -4.8)');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as RenderFeature[];\n            expect(actual[0].getType()).toEqual('LineString');\n            expect(actual[0].getFlatCoordinates()).toEqual([1.2, -2.1, 2.4, -4.8]);\n        });\n\n        it('Polygon', async () => {\n            const expected = makeFeatureCollection('POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))');\n            const actual = (await takeAsync<FeatureLike>(deserialize(fc, serialize(fc, expected)))) as RenderFeature[];\n            expect(actual[0].getType()).toEqual('Polygon');\n            expect(actual[0].getFlatCoordinates()).toEqual([30, 10, 40, 40, 20, 40, 10, 20, 30, 10]);\n        });\n    });\n\n    describe('Transforms geometry to another projection', () => {\n        describe('Point', () => {\n            const points = makeFeatureCollection('POINT(13 56)');\n            const expected = transform([13, 56], 'EPSG:4326', 'EPSG:3857');\n\n            it('Point to Feature', async () => {\n                const fc = new FeatureCollection({\n                    dataProjection: 'EPSG:4326',\n                    featureProjection: 'EPSG:3857',\n                });\n                const s = serialize(fc, points);\n                const actual = (await takeAsync<FeatureLike>(deserialize(fc, s))) as Feature[];\n                const actualGeometry = actual[0].getGeometry() as Point;\n                expect(actualGeometry.getFlatCoordinates()).toEqual(expected);\n            });\n\n            it('Point to RenderFeature', async () => {\n                const fc = new FeatureCollection({\n                    featureClass: RenderFeature,\n                    dataProjection: 'EPSG:4326',\n                    featureProjection: 'EPSG:3857',\n                });\n                const s = serialize(fc, points);\n                const actual = (await takeAsync<FeatureLike>(deserialize(fc, s))) as RenderFeature[];\n                expect(actual[0].getFlatCoordinates()).toEqual(expected);\n            });\n        });\n    });\n});\n"],"names":["readFileSync","Feature","GeoJSON","WKT","transform","RenderFeature","describe","expect","it","deserialize","FeatureCollection","serialize","arrayToStream","takeAsync","format","geojson","g","features","writeFeatures","makeFeatureCollection","wkt","makeFeatureCollectionFromArray","wkts","geometries","map","readGeometry","geometry","index","f","setId","fc","expected","s","to","equal","stream","type","id","properties","test","coordinates","JSON","parse","readFeatures","deep","bytes","Uint8Array","length","eq","getGeometry","getCoordinates","be","greaterThan","buffer","name","featureClass","actual","getType","toEqual","getFlatCoordinates","points","dataProjection","featureProjection","actualGeometry"],"mappings":"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"}